<!DOCTYPE html>
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>Nails by Livia - Facturation</title>
		<link rel="icon" type="image/png" href="logo_favicon.png" />
		<style>
			*{
				font-family:Arial;
			}
			html,body{
				height:100%;
				margin:20px;
			}
			.page{
				width:20.9cm;
				height:29.6cm;
				border:0.05cm solid black;
				padding:1cm;
			}
			.pink{
				background-color:#cf87d3;
				color:#fff;
				font-weight:bold;
			}
			.void{
				border:none;
			}
			#cont1{
				display:inline-block;
			}
			#cont2{
				display:inline-block;
				float:right;
			}
			#cont3{
				padding-top:100px;
			}
			#cont4{
				padding-top:50px;
			}
			#logo1{
				width:5cm;
				height:auto;
			}
			#logo2{
				width:5cm;
				height:auto;
			}
			#adresse{
				font-size:10pt;
				line-height:1.5;
			}
			#fac{
				width:5cm;
				text-align:center;
				font-weight:bold;
				font-style:italic;
				font-size:1.75em;
				color:#9b3aa0;
				line-height:0.25;
			}
			
			table, tr, td{
				border-collapse:collapse;
			}
			
			table{
				width:100%;
			}

			td{
				padding:0.125cm;
				border:1px solid #cf87d3;
			}
			
			/* Styles pour le menu de sélection */
			.menu-selection {
				background: #f8f8f8;
				padding: 15px;
				margin-bottom: 20px;
				border: 2px solid #cf87d3;
				border-radius: 8px;
			}
			
			.menu-selection select, .menu-selection button {
				padding: 8px 12px;
				margin: 5px;
				border: 1px solid #cf87d3;
				border-radius: 4px;
				font-size: 14px;
			}
			
			.menu-selection button {
				background-color: #cf87d3;
				color: white;
				cursor: pointer;
				font-weight: bold;
			}
			
			.menu-selection button:hover {
				background-color: #9b3aa0;
			}
			
			/* Styles pour les inputs avec euros */
			.input-container {
				position: relative;
				display: inline-block;
				width: 100%;
			}
			
			.input-container input {
				width: 100%;
				padding-right: 25px;
				box-sizing: border-box;
			}
			
			.euro-suffix {
				position: absolute;
				right: 8px;
				top: 50%;
				transform: translateY(-50%);
				color: #666;
				pointer-events: none;
			}
			
			/* Styles d'impression */
			@media print {
				html, body{
					margin:0;
				}
				.page{
					border:none;
				}
				input{
					border:none;
					background: transparent;
				}
				.menu-selection {
					display: none !important;
				}
				.euro-suffix {
					display: inline !important;
				}
			}
			
			/* MODIFICATIONS: Make the QTÉ column much smaller */
			#tableauServices {
				table-layout: fixed;
			}
			
			#tableauServices td:nth-child(1) { /* DESCRIPTION */
				width: 60%;
			}
			
			#tableauServices td:nth-child(2) { /* QTÉ - Made much smaller */
				width: 8%;
				text-align: center;
			}
			
			#tableauServices td:nth-child(3) { /* PRIX UNITAIRE */
				width: 16%;
			}
			
			#tableauServices td:nth-child(4) { /* MONTANT */
				width: 16%;
			}
			
			/* Ensure inputs in the QTÉ column are centered and smaller */
			#tableauServices td:nth-child(2) input {
				text-align: center;
				width: 100%;
			}
			
			.large{
				width:11cm;
			}
			
			.small{
				width:0.5cm;
			}
		</style>
	</head>
	<body>
		<!-- Menu de sélection des factures -->
		<div class="menu-selection">
			<label for="selectFacture">Choisir une facture : </label>
			<select id="selectFacture">
				<option value="">-- Nouvelle facture --</option>
			</select>
			<button onclick="chargerFacture()">Charger la facture</button>
			<!-- <button onclick="sauvegarderFacture()">Sauvegarder</button> -->
			<button onclick="imprimerFacture()">Imprimer/PDF</button>
			<button onclick="nouvelleFacture()">Nouvelle Facture</button>
		</div>
		
		<div class="page">
			<div id="cont1">
				<img src="https://leblog92.github.io/liviabeaute/logo_NBL.png" id="logo1"/>
			</div>
			<div id="cont2">
				<img src="https://leblog92.github.io/liviabeaute/visuel.png" id="logo2"/><br>
				<p id="fac">FACTURE</p>
			</div>
			<div id="adresse">
				<p>
					252 avenue Napoléon Bonaparte<br>
					92500 RUEIL-MALMAISON<br>
					Téléphone : 07 64 69 37 90<br>
					SIRET / 451 127 948 000 29
				</p>
			</div>
			
			<div id="cont3">
			<hr>
				<table>
					<colgroup>
					<tbody>
						<tr>
							<td class="pink">FACTURER À</td>
							<td class="void"></td>
							<td class="pink">N° FACTURE</td>
							<td class="pink">DATE</td>
						</tr>
						<tr>
							<td><input id="clientInput"/></td>
							<td class="void"></td>
							<td><input type="text" id="refInput" value="LV0001"/></td>
							<td><input type="date" id="dateInput"/></td>
						</tr>
					</tbody>
				</table>
			</div>
			<div id="cont4">
				<table id="tableauServices">
				<tr>
					<td class="pink">DESCRIPTION</td>
					<td class="pink">QTÉ</td>
					<td class="pink">PRIX UNITAIRE</td>
					<td class="pink">MONTANT</td>
				</tr>
				<!-- Lignes générées dynamiquement -->
				</table>
				
				<table style="margin-top: 20px;">
					<tr>
						<td class="pink" colspan="2">Nous vous remercions de votre confiance</td>
						<td class="pink">MONTANT</td>
						<td class="pink">
							<div class="input-container">
								<input type="number" id="totalInput" readonly/>
								<span class="euro-suffix">€</span>
							</div>
						</td>
					</tr>				
				</table>
			</div>
		</div>
		
		<script>
			// Données des factures existantes
		const factures = [
    {date: "2024-09-01", montant: "50", cliente: "Nadia Haie", service: "-", reference: "LV20240901"},
    {date: "2024-09-02", montant: "25", cliente: "Anabelle", service: "-", reference: "LV20240902"},
    {date: "2024-09-03", montant: "60", cliente: "Anais", service: "-", reference: "LV20240903"},
    {date: "2024-09-03", montant: "100", cliente: "Joelle", service: "-", reference: "LV20240904"},
    {date: "2024-09-05", montant: "20", cliente: "Nicole", service: "-", reference: "LV20240905"},
    {date: "2024-09-06", montant: "45", cliente: "Anna", service: "-", reference: "LV20240906"},
    {date: "2024-09-07", montant: "25", cliente: "Nina", service: "-", reference: "LV20240907"},
    {date: "2024-09-07", montant: "30", cliente: "Mélanie", service: "-", reference: "LV20240908"},
    {date: "2024-09-21", montant: "45", cliente: "Anna", service: "-", reference: "LV20240909"},
    {date: "2024-09-22", montant: "50", cliente: "Nadia HAIE", service: "-", reference: "LV20240910"},
    {date: "2024-09-22", montant: "60", cliente: "Mélanie", service: "-", reference: "LV20240911"},
    {date: "2024-09-28", montant: "50", cliente: "Annabelle", service: "-", reference: "LV20240912"},
    {date: "2024-09-28", montant: "35", cliente: "Christelle", service: "-", reference: "LV20240913"},
    {date: "2024-09-30", montant: "45", cliente: "Yamina", service: "-", reference: "LV20240914"},
    {date: "2024-10-02", montant: "50", cliente: "Madeleine", service: "Biab ", reference: "LV20241001"},
    {date: "2024-10-05", montant: "75", cliente: "Benigna", service: "-", reference: "LV20241002"},
    {date: "2024-10-16", montant: "45", cliente: "Anna", service: "-", reference: "LV20241003"},
    {date: "2024-10-20", montant: "40", cliente: "Anabelle", service: "Prot base sur 2 ongles minerale base en 1 couche et pose vsp", reference: "LV20241004"},
    {date: "2024-10-20", montant: "70", cliente: "Florine", service: "Remplissage Biab et depose gel exterieur", reference: "LV20241005"},
    {date: "2024-10-20", montant: "60", cliente: "Yamina", service: "Prot base sur tous les ongles et gummy base beige", reference: "LV20241006"},
    {date: "2024-10-21", montant: "50", cliente: "Nadia Haie", service: "-", reference: "LV20241007"},
    {date: "2024-10-27", montant: "30", cliente: "Laura", service: "-", reference: "LV20241008"},
    {date: "2024-11-05", montant: "45", cliente: "Anna", service: "Remp gel", reference: "LV20241101"},
    {date: "2024-11-14", montant: "60", cliente: "Laura", service: "dep vsp et biab", reference: "LV20241102"},
    {date: "2024-11-15", montant: "25", cliente: "-", service: "-", reference: "LV20241103"},
    {date: "2024-11-17", montant: "50", cliente: "-", service: "-", reference: "LV20241104"},
    {date: "2024-11-20", montant: "45", cliente: "Mélanie", service: "Remp Biab 3h", reference: "LV20241105"},
    {date: "2024-11-23", montant: "45", cliente: "Anabelle", service: "-", reference: "LV20241106"},
    {date: "2024-11-30", montant: "45", cliente: "Anna", service: "-", reference: "LV20241107"},
    {date: "2024-11-30", montant: "55", cliente: "Madeleine", service: "-", reference: "LV20241108"},
    {date: "2024-12-07", montant: "50", cliente: "Laura", service: "Remplissage TGB et 1 ongle cassé", reference: "LV20241201"},
    {date: "2025-01-04", montant: "15", cliente: "Madeleine", service: "Depose biab", reference: "LV20250101"},
    {date: "2025-02-22", montant: "15", cliente: "Megan", service: "dep gel et nouvo biab clear", reference: "LV20250201"},
    {date: "2025-03-23", montant: "45", cliente: "Marine", service: "Min base ind et vsp marron et man", reference: "LV20250301"},
    {date: "2025-04-06", montant: "50", cliente: "Laura", service: "remp biab 1 dimanche cadeau du dimanche offert à déduire du prochain bonus des 5 passages", reference: "LV20250401"},
    {date: "2025-04-18", montant: "40", cliente: "Marine", service: "fin de dep man rapide pose semi rouge avec min base indigo", reference: "LV20250402"},
    {date: "2025-04-22", montant: "50", cliente: "Nathalie", service: "Biab", reference: "LV20250403"},
    {date: "2025-04-27", montant: "80", cliente: "Eva Pompier", service: "Man pose cap Am vsp", reference: "LV20250404"},
    {date: "2025-05-21", montant: "100", cliente: "Anne-Marie ", service: "Dep Man pose vsp min base ped vsp", reference: "LV20250501"},
    {date: "2025-05-28", montant: "45", cliente: "Charlotte 2 ", service: "Pour sa maman payé et à faire Man et vsp", reference: "LV20250502"},
    {date: "2025-06-09", montant: "60", cliente: "Clotilde", service: "Man Russe et pose de vsp", reference: "LV20250601"},
    {date: "2025-06-11", montant: "15", cliente: "Anais", service: "BDP et Vsp", reference: "LV20250602"},
    {date: "2025-06-13", montant: "50", cliente: "Laurence Piat", service: "Kdo de sa fille Charlotte et BDP et vsp sur les mains Gumy base rose shimmer prochaine fois vieux rose cat eyes sur les pieds A239", reference: "LV20250603"},
    {date: "2025-06-16", montant: "25", cliente: "Alienor", service: "-", reference: "LV20250604"},
    {date: "2025-06-25", montant: "10", cliente: "Clotilde", service: "Depose", reference: "LV20250605"},
    {date: "2025-07-04", montant: "100", cliente: "Adeline", service: "-", reference: "LV20250701"},
    {date: "2025-07-21", montant: "45", cliente: "Marion", service: "Remp Biab Soçucis gel clear remise prochaine fois et 5 eme pass", reference: "LV20250702"},
    {date: "2025-07-26", montant: "30", cliente: "Josephine", service: "Pose vsp", reference: "LV20250703"},
    {date: "2025-07-26", montant: "30", cliente: "Mme Diamant", service: "Pose vsp", reference: "LV20250704"},
    {date: "2025-07-28", montant: "50", cliente: "Emmanuelle", service: "Forfait Dep Man Pose", reference: "LV20250705"}
];

			// Initialisation
			document.addEventListener('DOMContentLoaded', function() {
				initialiserMenuFactures();
				creerLignesServices(10);
				calculerTotal();
				mettreAJourDate();
				mettreAJourTitre(); // Initialiser le titre
			});

			// Initialise le menu déroulant des factures
			function initialiserMenuFactures() {
				const select = document.getElementById('selectFacture');
				factures.forEach((facture, index) => {
					const option = document.createElement('option');
					option.value = index;
					option.textContent = `${facture.reference} - ${facture.cliente} - ${facture.date}`;
					select.appendChild(option);
				});
			}

			// Crée les lignes de services dans le tableau
			function creerLignesServices(nombreLignes) {
				const tableau = document.getElementById('tableauServices');
				// Garde l'en-tête
				while (tableau.rows.length > 1) {
					tableau.deleteRow(1);
				}
				
				for (let i = 0; i < nombreLignes; i++) {
					const ligne = tableau.insertRow();
					
					// Colonne Description
					const cellDescription = ligne.insertCell();
					cellDescription.innerHTML = `<input type="text" class="description large" onchange="calculerTotal()">`;
					
					// Colonne Quantité
					const cellQuantite = ligne.insertCell();
					cellQuantite.innerHTML = `<input type="number" class="quantite small" value="1" min="0" onchange="calculerTotal()">`;
					
					// Colonne Prix Unitaire
					const cellPrixUnitaire = ligne.insertCell();
					cellPrixUnitaire.innerHTML = `
						<div class="input-container">
							<input type="number" class="prix-unitaire" step="0.01" min="0" onchange="calculerTotal()">
							<span class="euro-suffix">€</span>
						</div>
					`;
					
					// Colonne Montant
					const cellMontant = ligne.insertCell();
					cellMontant.innerHTML = `
						<div class="input-container">
							<input type="number" class="montant" step="0.01" min="0" readonly>
							<span class="euro-suffix">€</span>
						</div>
					`;
				}
			}

			// Calcule le total de la facture
			function calculerTotal() {
				let total = 0;
				const lignes = document.querySelectorAll('#tableauServices tr');
				
				for (let i = 1; i < lignes.length; i++) {
					const quantite = parseFloat(lignes[i].querySelector('.quantite').value) || 0;
					const prixUnitaire = parseFloat(lignes[i].querySelector('.prix-unitaire').value) || 0;
					const montant = quantite * prixUnitaire;
					
					// Met à jour le montant de la ligne
					const inputMontant = lignes[i].querySelector('.montant');
					inputMontant.value = montant.toFixed(2);
					
					total += montant;
				}
				
				// Met à jour le total général
				document.getElementById('totalInput').value = total.toFixed(2);
				
				// Met à jour le titre de la page
				mettreAJourTitre();
			}

			// Charge une facture depuis le menu
			function chargerFacture() {
				const select = document.getElementById('selectFacture');
				const index = select.value;
				
				if (index === "") {
					return; // Nouvelle facture
				}
				
				const facture = factures[index];
				document.getElementById('clientInput').value = facture.cliente;
				document.getElementById('refInput').value = facture.reference;
				document.getElementById('dateInput').value = facture.date;
				
				// Remplit la première ligne avec les données de la facture
				const premiereLigne = document.querySelector('#tableauServices tr:nth-child(2)');
				if (premiereLigne) {
					premiereLigne.querySelector('.description').value = facture.service;
					premiereLigne.querySelector('.quantite').value = 1;
					premiereLigne.querySelector('.prix-unitaire').value = facture.montant;
				}
				
				calculerTotal();
				mettreAJourTitre(); // Mettre à jour le titre après le chargement
			}

			// Sauvegarde la facture actuelle
			function sauvegarderFacture() {
				const reference = document.getElementById('refInput').value;
				const cliente = document.getElementById('clientInput').value;
				const date = document.getElementById('dateInput').value;
				
				alert(`Facture ${reference} sauvegardée pour ${cliente}`);
				// Ici vous pourriez sauvegarder dans localStorage ou envoyer à un serveur
			}

			// Crée une nouvelle facture
			function nouvelleFacture() {
				document.getElementById('clientInput').value = '';
				document.getElementById('refInput').value = 'LV' + (factures.length + 1).toString().padStart(4, '0');
				document.getElementById('dateInput').value = '';
				
				// Réinitialise toutes les lignes
				document.querySelectorAll('#tableauServices input').forEach(input => {
					if (input.classList.contains('quantite')) {
						input.value = 1;
					} else {
						input.value = '';
					}
				});
				
				document.getElementById('selectFacture').value = "";
				calculerTotal();
				mettreAJourDate();
				mettreAJourTitre(); // Mettre à jour le titre après la création
			}

			// Met à jour la date avec la date du jour
			function mettreAJourDate() {
				const aujourdhui = new Date().toISOString().split('T')[0];
				if (!document.getElementById('dateInput').value) {
					document.getElementById('dateInput').value = aujourdhui;
				}
			}

			// Imprime la facture
			function imprimerFacture() {
				window.print();
			}
			
			// Met à jour le titre de la page en fonction de la facture affichée
			function mettreAJourTitre() {
				const reference = document.getElementById('refInput').value;
				const cliente = document.getElementById('clientInput').value;
				const total = document.getElementById('totalInput').value;
				
				let titre = 'Nails by Livia - Facturation';
				
				if (reference && reference !== 'LV0001') {
					titre = `Facture ${reference} - Nails by Livia`;
					
					if (cliente) {
						titre = `Facture ${reference} - ${cliente} - Nails by Livia`;
					}
					
					if (total && total !== '0.00') {
						titre += ` - ${total}€`;
					}
				}
				
				document.title = titre;
			}
			
			// Ajout d'écouteurs d'événements pour mettre à jour le titre lors de la modification des champs
			document.getElementById('refInput').addEventListener('input', mettreAJourTitre);
			document.getElementById('clientInput').addEventListener('input', mettreAJourTitre);
			document.getElementById('dateInput').addEventListener('change', mettreAJourTitre);
		</script>
	</body>
</html>